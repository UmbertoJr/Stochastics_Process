"0","ferguson.def <- function(number.obs, M){"
"0","  sample <- seq(from=-5, to=5, length.out = number.obs)"
"0","  par <- rep(0,number.obs)"
"0","  sim <- rep(0,number.obs)"
"0","  par[1] <- M*pnorm(sample[1])"
"0","  sim[1] <- rgamma(1,par[1])"
"0","  for(i in 2:number.obs){"
"0","    par[i] <- M*(pnorm(sample[i]) - pnorm(sample[i-1]))"
"0","    sim[i] <- rgamma(1,par[i])"
"0","  }"
"0","  tot <- sum(sim)"
"0","  ret <- sim/tot"
"0","  return(ret)"
"0","}"
"0","M <- c(5, 20 , 50, 100)"
"0","number.obs=100"
"0","sim= 100"
"0","a <- list()"
"0","for(i in 1:4){"
"0","  a[[i]] <- matrix(nrow = sim, ncol = number.obs)"
"0","  for(l in 1:sim)"
"0","  a[[i]][l,] <- ferguson.def(number.obs,M=M[i])"
"0","}"
